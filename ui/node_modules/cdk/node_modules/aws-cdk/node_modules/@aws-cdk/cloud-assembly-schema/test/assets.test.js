"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const fs = require("fs");
const os = require("os");
const path = require("path");
const lib_1 = require("../lib");
describe('Docker image asset', () => {
    test('valid input', () => {
        expect(() => {
            validate({
                version: lib_1.Manifest.version(),
                dockerImages: {
                    asset: {
                        source: {
                            directory: '.',
                        },
                        destinations: {
                            dest: {
                                region: 'us-north-20',
                                repositoryName: 'REPO',
                                imageTag: 'TAG',
                            },
                        },
                    },
                },
            });
        }).not.toThrow();
    });
    test('invalid input', () => {
        expect(() => {
            validate({
                version: lib_1.Manifest.version(),
                dockerImages: {
                    asset: {
                        source: {},
                        destinations: {},
                    },
                },
            });
        }).toThrow(/instance\.dockerImages\.asset\.source requires property \"directory\"/);
    });
});
describe('File asset', () => {
    describe('valid input', () => {
        test('without packaging', () => {
            expect(() => {
                validate({
                    version: lib_1.Manifest.version(),
                    files: {
                        asset: {
                            source: {
                                path: 'a/b/c',
                            },
                            destinations: {
                                dest: {
                                    region: 'us-north-20',
                                    bucketName: 'Bouquet',
                                    objectKey: 'key',
                                },
                            },
                        },
                    },
                });
            }).not.toThrow();
        });
        for (const packaging of Object.values(lib_1.FileAssetPackaging)) {
            test(`with "${packaging}" packaging`, () => {
                expect(() => {
                    validate({
                        version: lib_1.Manifest.version(),
                        files: {
                            asset: {
                                source: {
                                    path: 'a/b/c',
                                    packaging,
                                },
                                destinations: {
                                    dest: {
                                        region: 'us-north-20',
                                        bucketName: 'Bouquet',
                                        objectKey: 'key',
                                    },
                                },
                            },
                        },
                    });
                }).not.toThrow();
            });
        }
    });
    describe('invalid input', () => {
        test('bad "source.path" property', () => {
            expect(() => {
                validate({
                    version: lib_1.Manifest.version(),
                    files: {
                        asset: {
                            source: {
                                path: 3,
                            },
                            destinations: {
                                dest: {
                                    region: 'us-north-20',
                                    bucketName: 'Bouquet',
                                    objectKey: 'key',
                                },
                            },
                        },
                    },
                });
            }).toThrow(/instance\.files\.asset\.source\.path is not of a type\(s\) string/);
        });
        test('bad "source.packaging" property', () => {
            expect(() => {
                validate({
                    version: lib_1.Manifest.version(),
                    files: {
                        asset: {
                            source: {
                                path: 'a/b/c',
                                packaging: 'BLACK_HOLE',
                            },
                            destinations: {
                                dest: {
                                    region: 'us-north-20',
                                    bucketName: 'Bouquet',
                                    objectKey: 'key',
                                },
                            },
                        },
                    },
                });
            }).toThrow(/instance\.files\.asset\.source\.packaging is not one of enum values: file,zip/);
        });
    });
});
function validate(manifest) {
    const dir = fs.mkdtempSync(path.join(os.tmpdir(), 'assets.test.'));
    const filePath = path.join(dir, 'manifest.json');
    fs.writeFileSync(filePath, JSON.stringify(manifest, undefined, 2));
    try {
        lib_1.Manifest.loadAssetManifest(filePath);
    }
    finally {
        fs.unlinkSync(filePath);
        fs.rmdirSync(dir);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXNzZXRzLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJhc3NldHMudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHlCQUF5QjtBQUN6Qix5QkFBeUI7QUFDekIsNkJBQTZCO0FBQzdCLGdDQUFzRDtBQUV0RCxRQUFRLENBQUMsb0JBQW9CLEVBQUUsR0FBRyxFQUFFO0lBQ2xDLElBQUksQ0FBQyxhQUFhLEVBQUUsR0FBRyxFQUFFO1FBQ3ZCLE1BQU0sQ0FBQyxHQUFHLEVBQUU7WUFDVixRQUFRLENBQUM7Z0JBQ1AsT0FBTyxFQUFFLGNBQVEsQ0FBQyxPQUFPLEVBQUU7Z0JBQzNCLFlBQVksRUFBRTtvQkFDWixLQUFLLEVBQUU7d0JBQ0wsTUFBTSxFQUFFOzRCQUNOLFNBQVMsRUFBRSxHQUFHO3lCQUNmO3dCQUNELFlBQVksRUFBRTs0QkFDWixJQUFJLEVBQUU7Z0NBQ0osTUFBTSxFQUFFLGFBQWE7Z0NBQ3JCLGNBQWMsRUFBRSxNQUFNO2dDQUN0QixRQUFRLEVBQUUsS0FBSzs2QkFDaEI7eUJBQ0Y7cUJBQ0Y7aUJBQ0Y7YUFDRixDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFFLENBQUM7SUFDbkIsQ0FBQyxDQUFDLENBQUM7SUFFSCxJQUFJLENBQUMsZUFBZSxFQUFFLEdBQUcsRUFBRTtRQUN6QixNQUFNLENBQUMsR0FBRyxFQUFFO1lBQ1YsUUFBUSxDQUFDO2dCQUNQLE9BQU8sRUFBRSxjQUFRLENBQUMsT0FBTyxFQUFFO2dCQUMzQixZQUFZLEVBQUU7b0JBQ1osS0FBSyxFQUFFO3dCQUNMLE1BQU0sRUFBRSxFQUFFO3dCQUNWLFlBQVksRUFBRSxFQUFFO3FCQUNqQjtpQkFDRjthQUNGLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyx1RUFBdUUsQ0FBQyxDQUFDO0lBQ3RGLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUM7QUFFSCxRQUFR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QUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUM7QUFFSCxTQUFTLFFBQVEsQ0FBQyxRQUFhO0lBQzdCLE1BQU0sR0FBRyxHQUFHLEVBQUUsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsTUFBTSxFQUFFLEVBQUUsY0FBYyxDQUFDLENBQUMsQ0FBQztJQUNuRSxNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxlQUFlLENBQUMsQ0FBQztJQUNqRCxFQUFFLENBQUMsYUFBYSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsRUFBRSxTQUFTLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNuRSxJQUFJO1FBQ0YsY0FBUSxDQUFDLGlCQUFpQixDQUFDLFFBQVEsQ0FBQyxDQUFDO0tBQ3RDO1lBQVM7UUFDUixFQUFFLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ3hCLEVBQUUsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLENBQUM7S0FDbkI7QUFDSCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMnO1xuaW1wb3J0ICogYXMgb3MgZnJvbSAnb3MnO1xuaW1wb3J0ICogYXMgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCB7IEZpbGVBc3NldFBhY2thZ2luZywgTWFuaWZlc3QgfSBmcm9tICcuLi9saWInO1xuXG5kZXNjcmliZSgnRG9ja2VyIGltYWdlIGFzc2V0JywgKCkgPT4ge1xuICB0ZXN0KCd2YWxpZCBpbnB1dCcsICgpID0+IHtcbiAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgdmFsaWRhdGUoe1xuICAgICAgICB2ZXJzaW9uOiBNYW5pZmVzdC52ZXJzaW9uKCksXG4gICAgICAgIGRvY2tlckltYWdlczoge1xuICAgICAgICAgIGFzc2V0OiB7XG4gICAgICAgICAgICBzb3VyY2U6IHtcbiAgICAgICAgICAgICAgZGlyZWN0b3J5OiAnLicsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZGVzdGluYXRpb25zOiB7XG4gICAgICAgICAgICAgIGRlc3Q6IHtcbiAgICAgICAgICAgICAgICByZWdpb246ICd1cy1ub3J0aC0yMCcsXG4gICAgICAgICAgICAgICAgcmVwb3NpdG9yeU5hbWU6ICdSRVBPJyxcbiAgICAgICAgICAgICAgICBpbWFnZVRhZzogJ1RBRycsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9KS5ub3QudG9UaHJvdygpO1xuICB9KTtcblxuICB0ZXN0KCdpbnZhbGlkIGlucHV0JywgKCkgPT4ge1xuICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICB2YWxpZGF0ZSh7XG4gICAgICAgIHZlcnNpb246IE1hbmlmZXN0LnZlcnNpb24oKSxcbiAgICAgICAgZG9ja2VySW1hZ2VzOiB7XG4gICAgICAgICAgYXNzZXQ6IHtcbiAgICAgICAgICAgIHNvdXJjZToge30sXG4gICAgICAgICAgICBkZXN0aW5hdGlvbnM6IHt9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9KS50b1Rocm93KC9pbnN0YW5jZVxcLmRvY2tlckltYWdlc1xcLmFzc2V0XFwuc291cmNlIHJlcXVpcmVzIHByb3BlcnR5IFxcXCJkaXJlY3RvcnlcXFwiLyk7XG4gIH0pO1xufSk7XG5cbmRlc2NyaWJlKCdGaWxlIGFzc2V0JywgKCkgPT4ge1xuICBkZXNjcmliZSgndmFsaWQgaW5wdXQnLCAoKSA9PiB7XG4gICAgdGVzdCgnd2l0aG91dCBwYWNrYWdpbmcnLCAoKSA9PiB7XG4gICAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgICB2YWxpZGF0ZSh7XG4gICAgICAgICAgdmVyc2lvbjogTWFuaWZlc3QudmVyc2lvbigpLFxuICAgICAgICAgIGZpbGVzOiB7XG4gICAgICAgICAgICBhc3NldDoge1xuICAgICAgICAgICAgICBzb3VyY2U6IHtcbiAgICAgICAgICAgICAgICBwYXRoOiAnYS9iL2MnLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBkZXN0aW5hdGlvbnM6IHtcbiAgICAgICAgICAgICAgICBkZXN0OiB7XG4gICAgICAgICAgICAgICAgICByZWdpb246ICd1cy1ub3J0aC0yMCcsXG4gICAgICAgICAgICAgICAgICBidWNrZXROYW1lOiAnQm91cXVldCcsXG4gICAgICAgICAgICAgICAgICBvYmplY3RLZXk6ICdrZXknLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSkubm90LnRvVGhyb3coKTtcbiAgICB9KTtcblxuICAgIGZvciAoY29uc3QgcGFja2FnaW5nIG9mIE9iamVjdC52YWx1ZXMoRmlsZUFzc2V0UGFja2FnaW5nKSkge1xuICAgICAgdGVzdChgd2l0aCBcIiR7cGFja2FnaW5nfVwiIHBhY2thZ2luZ2AsICgpID0+IHtcbiAgICAgICAgZXhwZWN0KCgpID0+IHtcbiAgICAgICAgICB2YWxpZGF0ZSh7XG4gICAgICAgICAgICB2ZXJzaW9uOiBNYW5pZmVzdC52ZXJzaW9uKCksXG4gICAgICAgICAgICBmaWxlczoge1xuICAgICAgICAgICAgICBhc3NldDoge1xuICAgICAgICAgICAgICAgIHNvdXJjZToge1xuICAgICAgICAgICAgICAgICAgcGF0aDogJ2EvYi9jJyxcbiAgICAgICAgICAgICAgICAgIHBhY2thZ2luZyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uczoge1xuICAgICAgICAgICAgICAgICAgZGVzdDoge1xuICAgICAgICAgICAgICAgICAgICByZWdpb246ICd1cy1ub3J0aC0yMCcsXG4gICAgICAgICAgICAgICAgICAgIGJ1Y2tldE5hbWU6ICdCb3VxdWV0JyxcbiAgICAgICAgICAgICAgICAgICAgb2JqZWN0S2V5OiAna2V5JyxcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pLm5vdC50b1Rocm93KCk7XG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdpbnZhbGlkIGlucHV0JywgKCkgPT4ge1xuICAgIHRlc3QoJ2JhZCBcInNvdXJjZS5wYXRoXCIgcHJvcGVydHknLCAoKSA9PiB7XG4gICAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgICB2YWxpZGF0ZSh7XG4gICAgICAgICAgdmVyc2lvbjogTWFuaWZlc3QudmVyc2lvbigpLFxuICAgICAgICAgIGZpbGVzOiB7XG4gICAgICAgICAgICBhc3NldDoge1xuICAgICAgICAgICAgICBzb3VyY2U6IHtcbiAgICAgICAgICAgICAgICBwYXRoOiAzLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBkZXN0aW5hdGlvbnM6IHtcbiAgICAgICAgICAgICAgICBkZXN0OiB7XG4gICAgICAgICAgICAgICAgICByZWdpb246ICd1cy1ub3J0aC0yMCcsXG4gICAgICAgICAgICAgICAgICBidWNrZXROYW1lOiAnQm91cXVldCcsXG4gICAgICAgICAgICAgICAgICBvYmplY3RLZXk6ICdrZXknLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSkudG9UaHJvdygvaW5zdGFuY2VcXC5maWxlc1xcLmFzc2V0XFwuc291cmNlXFwucGF0aCBpcyBub3Qgb2YgYSB0eXBlXFwoc1xcKSBzdHJpbmcvKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ2JhZCBcInNvdXJjZS5wYWNrYWdpbmdcIiBwcm9wZXJ0eScsICgpID0+IHtcbiAgICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICAgIHZhbGlkYXRlKHtcbiAgICAgICAgICB2ZXJzaW9uOiBNYW5pZmVzdC52ZXJzaW9uKCksXG4gICAgICAgICAgZmlsZXM6IHtcbiAgICAgICAgICAgIGFzc2V0OiB7XG4gICAgICAgICAgICAgIHNvdXJjZToge1xuICAgICAgICAgICAgICAgIHBhdGg6ICdhL2IvYycsXG4gICAgICAgICAgICAgICAgcGFja2FnaW5nOiAnQkxBQ0tfSE9MRScsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGRlc3RpbmF0aW9uczoge1xuICAgICAgICAgICAgICAgIGRlc3Q6IHtcbiAgICAgICAgICAgICAgICAgIHJlZ2lvbjogJ3VzLW5vcnRoLTIwJyxcbiAgICAgICAgICAgICAgICAgIGJ1Y2tldE5hbWU6ICdCb3VxdWV0JyxcbiAgICAgICAgICAgICAgICAgIG9iamVjdEtleTogJ2tleScsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICB9KS50b1Rocm93KC9pbnN0YW5jZVxcLmZpbGVzXFwuYXNzZXRcXC5zb3VyY2VcXC5wYWNrYWdpbmcgaXMgbm90IG9uZSBvZiBlbnVtIHZhbHVlczogZmlsZSx6aXAvKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcblxuZnVuY3Rpb24gdmFsaWRhdGUobWFuaWZlc3Q6IGFueSkge1xuICBjb25zdCBkaXIgPSBmcy5ta2R0ZW1wU3luYyhwYXRoLmpvaW4ob3MudG1wZGlyKCksICdhc3NldHMudGVzdC4nKSk7XG4gIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5qb2luKGRpciwgJ21hbmlmZXN0Lmpzb24nKTtcbiAgZnMud3JpdGVGaWxlU3luYyhmaWxlUGF0aCwgSlNPTi5zdHJpbmdpZnkobWFuaWZlc3QsIHVuZGVmaW5lZCwgMikpO1xuICB0cnkge1xuICAgIE1hbmlmZXN0LmxvYWRBc3NldE1hbmlmZXN0KGZpbGVQYXRoKTtcbiAgfSBmaW5hbGx5IHtcbiAgICBmcy51bmxpbmtTeW5jKGZpbGVQYXRoKTtcbiAgICBmcy5ybWRpclN5bmMoZGlyKTtcbiAgfVxufSJdfQ==